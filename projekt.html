<!DOCTYPE html>
<html>
<head>
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<link rel="stylesheet" type="text/css" href="d3.slider.css" media="screen" />
<script src="d3.slider.js"></script>
<script src="https://d3js.org/d3-drag.v1.min.js"></script>
<script src="http://vizjs.org/viz.v1.1.0.min.js"></script>
<style>
ticks {
  font: 10px sans-serif;
}

.track,
.track-inset,
.track-overlay {
  stroke-linecap: round;
}

.track {
  stroke: #000;
  stroke-opacity: 0.3;
  stroke-width: 10px;
}

.track-inset {
  stroke: #ddd;
  stroke-width: 8px;
}

.track-overlay {
  pointer-events: stroke;
  stroke-width: 50px;
  stroke: transparent;
  cursor: crosshair;
}

.handle {
  fill: #fff;
  stroke: #000;
  stroke-opacity: 0.5;
  stroke-width: 1.25px;
}
</style>
</head>
<body>

<script>
var datarow=[{"Godine":   2000.,"Jabuke": 64077,"Kruške": 4352,"Breskve_i_nektarine": 6941,"Breskve": 0,"Nektarine": 0,"Marelice": 471,"Trešnje_i_višnje": 8416,"Trešnje": 2920,"Višnje": 5496,"Šljive": 22261,"Orasi": 4480,"Lješnjaci": "-","Bademi": 2357,"Smokve": 4084,"Jagode": 1085,"Bobičasto_voće_bez_jagoda": 0,"Naranče": 497,"Mandarinke": 18995,"Limuni": 403,"Grožđe": 182436,"Masline": 16215,"Svježe_voće_(okućnica)": 50943},
{"Godine":   2001.,"Jabuke": 22405,"Kruške": 2872,"Breskve_i_nektarine": 7085,"Breskve": 0,"Nektarine": 0,"Marelice": 233,"Trešnje_i_višnje": 8185,"Trešnje": 2233,"Višnje": 5952,"Šljive": 22123,"Orasi": 2971,"Lješnjaci": "-","Bademi": 2146,"Smokve": 3870,"Jagode": 1114,"Bobičasto_voće_bez_jagoda": 0,"Naranče": 583,"Mandarinke": 17656,"Limuni": 502,"Grožđe": 186175,"Masline": 19413,"Svježe_voće_(okućnica)": 41167},
{"Godine":   2002.,"Jabuke": 44160,"Kruške": 2878,"Breskve_i_nektarine": 8043,"Breskve": 0,"Nektarine": 0,"Marelice": 338,"Trešnje_i_višnje": 7552,"Trešnje": 2943,"Višnje": 4609,"Šljive": 11418,"Orasi": 2540,"Lješnjaci": "-","Bademi": 2175,"Smokve": 3695,"Jagode": 1331,"Bobičasto_voće_bez_jagoda": 0,"Naranče": 503,"Mandarinke": 15757,"Limuni": 472,"Grožđe": 188749,"Masline": 32955,"Svježe_voće_(okućnica)": 38121},
{"Godine":   2003.,"Jabuke": 46340,"Kruške": 3249,"Breskve_i_nektarine": 4848,"Breskve": 0,"Nektarine": 0,"Marelice": 368,"Trešnje_i_višnje": 7349,"Trešnje": 2516,"Višnje": 4833,"Šljive": 23745,"Orasi": 3183,"Lješnjaci": "-","Bademi": 1297,"Smokve": 3335,"Jagode": 1357,"Bobičasto_voće_bez_jagoda": 0,"Naranče": 463,"Mandarinke": 10449,"Limuni": 438,"Grožđe": 183451,"Masline": 9482,"Svježe_voće_(okućnica)": 44320},
{"Godine":   2004.,"Jabuke": 63092,"Kruške": 4926,"Breskve_i_nektarine": 5995,"Breskve": 0,"Nektarine": 0,"Marelice": 376,"Trešnje_i_višnje": 4551,"Trešnje": 2307,"Višnje": 2244,"Šljive": 33104,"Orasi": 3527,"Lješnjaci": 176,"Bademi": 1091,"Smokve": 3459,"Jagode": 1520,"Bobičasto_voće_bez_jagoda": 0,"Naranče": 332,"Mandarinke": 14470,"Limuni": 397,"Grožđe": 174536,"Masline": 20613,"Svježe_voće_(okućnica)": 67813},
{"Godine":   2005.,"Jabuke": 57298,"Kruške": 1591,"Breskve_i_nektarine": 5171,"Breskve": 0,"Nektarine": 0,"Marelice": 261,"Trešnje_i_višnje": 5084,"Trešnje": 3498,"Višnje": 1586,"Šljive": 12630,"Orasi": 7204,"Lješnjaci": 366,"Bademi": 777,"Smokve": 1108,"Jagode": 2156,"Bobičasto_voće_bez_jagoda": 0,"Naranče": 574,"Mandarinke": 7576,"Limuni": 213,"Grožđe": 181021,"Masline": 36602,"Svježe_voće_(okućnica)": 51945},
{"Godine":   2006.,"Jabuke": 57571,"Kruške": 3363,"Breskve_i_nektarine": 4721,"Breskve": 0,"Nektarine": 0,"Marelice": 724,"Trešnje_i_višnje": 5312,"Trešnje": 3141,"Višnje": 2171,"Šljive": 15288,"Orasi": 6890,"Lješnjaci": 702,"Bademi": 568,"Smokve": 914,"Jagode": 2553,"Bobičasto_voće_bez_jagoda": 0,"Naranče": 556,"Mandarinke": 41201,"Limuni": 218,"Grožđe": 179426,"Masline": 27530,"Svježe_voće_(okućnica)": 68773},
{"Godine":   2007.,"Jabuke": 62991,"Kruške": 4427,"Breskve_i_nektarine": 3696,"Breskve": 0,"Nektarine": 0,"Marelice": 675,"Trešnje_i_višnje": 5930,"Trešnje": 2723,"Višnje": 3207,"Šljive": 19867,"Orasi": 7510,"Lješnjaci": 957,"Bademi": 536,"Smokve": 1093,"Jagode": 1171,"Bobičasto_voće_bez_jagoda": 0,"Naranče": 531,"Mandarinke": 41655,"Limuni": 459,"Grožđe": 197979,"Masline": 34527,"Svježe_voće_(okućnica)": 82813},
{"Godine":   2008.,"Jabuke": 57341,"Kruške": 3294,"Breskve_i_nektarine": 5315,"Breskve": 0,"Nektarine": 0,"Marelice": 869,"Trešnje_i_višnje": 7654,"Trešnje": 3863,"Višnje": 3791,"Šljive": 15812,"Orasi": 1966,"Lješnjaci": 911,"Bademi": 651,"Smokve": 1388,"Jagode": 1342,"Bobičasto_voće_bez_jagoda": 0,"Naranče": 416,"Mandarinke": 48297,"Limuni": 247,"Grožđe": 185256,"Masline": 35955,"Svježe_voće_(okućnica)": 79360},
{"Godine":   2009.,"Jabuke": 73924,"Kruške": 3570,"Breskve_i_nektarine": 7806,"Breskve": 0,"Nektarine": 0,"Marelice": 464,"Trešnje_i_višnje": 5253,"Trešnje": 2126,"Višnje": 3127,"Šljive": 13579,"Orasi": 1964,"Lješnjaci": 1016,"Bademi": 1493,"Smokve": 1221,"Jagode": 1463,"Bobičasto_voće_bez_jagoda": 855,"Naranče": 524,"Mandarinke": 35907,"Limuni": 236,"Grožđe": 206437,"Masline": 32592,"Svježe_voće_(okućnica)": 71777},
{"Godine":   2010.,"Jabuke": 89124,"Kruške": 3308,"Breskve_i_nektarine": 6356,"Breskve": 5466,"Nektarine": 890,"Marelice": 408,"Trešnje_i_višnje": 4994,"Trešnje": 1115,"Višnje": 3879,"Šljive": 20403,"Orasi": 4279,"Lješnjaci": 2964,"Bademi": 143,"Smokve": 908,"Jagode": 1776,"Bobičasto_voće_bez_jagoda": 817,"Naranče": 202,"Mandarinke": 55000,"Limuni": 138,"Grožđe": 207743,"Masline": 38001,"Svježe_voće_(okućnica)": 60756},
{"Godine":   2011.,"Jabuke": 99676,"Kruške": 5083,"Breskve_i_nektarine": 8940,"Breskve": 7806,"Nektarine": 1134,"Marelice": 675,"Trešnje_i_višnje": 9081,"Trešnje": 2120,"Višnje": 6961,"Šljive": 24849,"Orasi": 2641,"Lješnjaci": 1548,"Bademi": 143,"Smokve": 1287,"Jagode": 1962,"Bobičasto_voće_bez_jagoda": 1193,"Naranče": 315,"Mandarinke": 41870,"Limuni": 200,"Grožđe": 204373,"Masline": 31423,"Svježe_voće_(okućnica)": 45923},
{"Godine":   2012.,"Jabuke": 37414,"Kruške": 1230,"Breskve_i_nektarine": 4618,"Breskve": 3516,"Nektarine": 1102,"Marelice": 244,"Trešnje_i_višnje": 6469,"Trešnje": 2342,"Višnje": 4127,"Šljive": 9936,"Orasi": 861,"Lješnjaci": 344,"Bademi": 1582,"Smokve": 1266,"Jagode": 1281,"Bobičasto_voće_bez_jagoda": 324,"Naranče": 269,"Mandarinke": 50786,"Limuni": 195,"Grožđe": 187550,"Masline": 50945,"Svježe_voće_(okućnica)": 23698},
{"Godine":   2013.,"Jabuke": 121738,"Kruške": 4124,"Breskve_i_nektarine": 4998,"Breskve": 3606,"Nektarine": 1392,"Marelice": 629,"Trešnje_i_višnje": 12227,"Trešnje": 3927,"Višnje": 8300,"Šljive": 29349,"Orasi": 902,"Lješnjaci": 1561,"Bademi": 74,"Smokve": 908,"Jagode": 3914,"Bobičasto_voće_bez_jagoda": 975,"Naranče": 145,"Mandarinke": 40024,"Limuni": 240,"Grožđe": 181096,"Masline": 34269,"Svježe_voće_(okućnica)": 26763},
{"Godine":   2014.,"Jabuke": 96703,"Kruške": 2909,"Breskve_i_nektarine": 4403,"Breskve": 3185,"Nektarine": 1218,"Marelice": 364,"Trešnje_i_višnje": 10688,"Trešnje": 795,"Višnje": 9893,"Šljive": 5649,"Orasi": 2848,"Lješnjaci": 908,"Bademi": 69,"Smokve": 725,"Jagode": 3167,"Bobičasto_voće_bez_jagoda": 478,"Naranče": 106,"Mandarinke": 64378,"Limuni": 181,"Grožđe": 134941,"Masline": 8840,"Svježe_voće_(okućnica)": 15105},
{"Godine":   2015.,"Jabuke": 96182,"Kruške": 3782,"Breskve_i_nektarine": 5261,"Breskve": 3659,"Nektarine": 1602,"Marelice": 337,"Trešnje_i_višnje": 6777,"Trešnje": 1405,"Višnje": 5372,"Šljive": 9069,"Orasi": 635,"Lješnjaci": 1462,"Bademi": 54,"Smokve": 699,"Jagode": 2367,"Bobičasto_voće_bez_jagoda": 1756,"Naranče": 158,"Mandarinke": 35722,"Limuni": 183,"Grožđe": 154227,"Masline": 28267,"Svježe_voće_(okućnica)": 16074}];
var datacol=[
{"type": "numeric", "name": "Godine", "values": [  2000.,  2001.,  2002.,  2003.,  2004.,  2005.,  2006.,  2007.,  2008.,  2009.,  2010.,  2011.,  2012.,  2013.,  2014.,  2015.]}
,{"type": "numeric", "name": "Jabuke", "values": [64077,22405,44160,46340,63092,57298,57571,62991,57341,73924,89124,99676,37414,121738,96703,96182]}
,{"type": "numeric", "name": "Kruške", "values": [4352,2872,2878,3249,4926,1591,3363,4427,3294,3570,3308,5083,1230,4124,2909,3782]}
,{"type": "numeric", "name": "Breskve_i_nektarine", "values": [6941,7085,8043,4848,5995,5171,4721,3696,5315,7806,6356,8940,4618,4998,4403,5261]}
,{"type": "numeric", "name": "Breskve", "values": [0,0,0,0,0,0,0,0,0,0,5466,7806,3516,3606,3185,3659]}
,{"type": "numeric", "name": "Nektarine", "values": [0,0,0,0,0,0,0,0,0,0,890,1134,1102,1392,1218,1602]}
,{"type": "numeric", "name": "Marelice", "values": [471,233,338,368,376,261,724,675,869,464,408,675,244,629,364,337]}
,{"type": "numeric", "name": "Trešnje_i_višnje", "values": [8416,8185,7552,7349,4551,5084,5312,5930,7654,5253,4994,9081,6469,12227,10688,6777]}
,{"type": "numeric", "name": "Trešnje", "values": [2920,2233,2943,2516,2307,3498,3141,2723,3863,2126,1115,2120,2342,3927,795,1405]}
,{"type": "numeric", "name": "Višnje", "values": [5496,5952,4609,4833,2244,1586,2171,3207,3791,3127,3879,6961,4127,8300,9893,5372]}
,{"type": "numeric", "name": "Šljive", "values": [22261,22123,11418,23745,33104,12630,15288,19867,15812,13579,20403,24849,9936,29349,5649,9069]}
,{"type": "numeric", "name": "Orasi", "values": [4480,2971,2540,3183,3527,7204,6890,7510,1966,1964,4279,2641,861,902,2848,635]}
,{"type": "numeric", "name": "Lješnjaci", "values": [0,0,0,0,176,366,702,957,911,1016,2964,1548,344,1561,908,1462]}
,{"type": "numeric", "name": "Bademi", "values": [2357,2146,2175,1297,1091,777,568,536,651,1493,143,143,1582,74,69,54]}
,{"type": "numeric", "name": "Smokve", "values": [4084,3870,3695,3335,3459,1108,914,1093,1388,1221,908,1287,1266,908,725,699]}
,{"type": "numeric", "name": "Jagode", "values": [1085,1114,1331,1357,1520,2156,2553,1171,1342,1463,1776,1962,1281,3914,3167,2367]}
,{"type": "numeric", "name": "Bobičasto_voće_bez_jagoda", "values": [0,0,0,0,0,0,0,0,0,855,817,1193,324,975,478,1756]}
,{"type": "numeric", "name": "Naranče", "values": [497,583,503,463,332,574,556,531,416,524,202,315,269,145,106,158]}
,{"type": "numeric", "name": "Mandarinke", "values": [18995,17656,15757,10449,14470,7576,41201,41655,48297,35907,55000,41870,50786,40024,64378,35722]}
,{"type": "numeric", "name": "Limuni", "values": [403,502,472,438,397,213,218,459,247,236,138,200,195,240,181,183]}
,{"type": "numeric", "name": "Grožđe", "values": [182436,186175,188749,183451,174536,181021,179426,197979,185256,206437,207743,204373,187550,181096,134941,154227]}
,{"type": "numeric", "name": "Masline", "values": [16215,19413,32955,9482,20613,36602,27530,34527,35955,32592,38001,31423,50945,34269,8840,28267]}
,{"type": "numeric", "name": "Svježe_voće_(okućnica)", "values": [50943,41167,38121,44320,67813,51945,68773,82813,79360,71777,60756,45923,23698,26763,15105,16074]}
];
var data= []
var i,j,k;
k=0;
for(i=1;i<23;i++){
 
	var fruit=datacol[i]["name"];
	for(j=0;i<16;i++){
	var yvalue=datacol[i]["values"][j];
	var year =datacol[0]["values"][j].toString();
	var fvalue=1;
	var column = [fruit,year,fvalue,yvalue];
	data[k] = column;
	k++;
}
}
console.log(data);
var margin = {top: 40, bottom: 150, left:100, right: 60};
var width = 500 - margin.left - margin.right;
var height = 500 - margin.top - margin.bottom;
var barPadding = 4;
var barWidth = width / datacol[0]["values"].length - barPadding;
var svg = d3.select("body")
.append("svg")
.attr("width", width)
.attr("height", height);
var x = d3.scale.linear()
    .domain([2000, 2015])
    .range([0, width-100])
    .clamp(true);
var slider = svg.append("g")
    .attr("class", "slider")
    .attr("transform", "translate(" + 50 + "," + height / 2 + ")");
slider.append("line")
    .attr("class", "track")
    .attr("x1", x.range()[0])
    .attr("x2", x.range()[1])
  .select(function() { return this.parentNode.appendChild(this.cloneNode(true)); })
    .attr("class", "track-inset")
  .select(function() { return this.parentNode.appendChild(this.cloneNode(true)); })
    .attr("class", "track-overlay")
    .call(d3.drag()
        .on("drag", function() {
		var newX = d3.mouse(this)[0];
            if (newX < x)
                newX = x;
            else if (newX > x + width)
                newX = x + width;
            handle.attr("x", newX);
			}));
slider.insert("g", ".track-overlay")
    .attr("class", "ticks")
    .attr("transform", "translate(0," + 20 + ")")
  .selectAll("text")
  .data(x.ticks(16))
  .enter().append("text")
    .attr("x", x)
    .attr("text-anchor", "middle")
    .text(function(d) { return d; });
var handle = slider.insert("rect", ".track-overlay")
    .attr("class", "handle")
	.attr("y","-10")
    .attr("width", 10)
	.attr("height", 20);
	
var width = 960, height=700;	
function fill(d){
  var color = {A:"#3366CC", B:"#DC3912",  C:"#FF9900"};
  return color[d.primary];
}

var svg = d3.select("body").append("svg").attr("width", width).attr("height", height);

var bp=viz.bP().data(data).fill(fill);
			
svg.append("g").attr("transform","translate(250,50)").call(bp);

// adjust the bl.ocks frame dimension.
d3.select(self.frameElement).style("height", height+"px").style("width", width+"px"); 
</script>
</body>
</html>